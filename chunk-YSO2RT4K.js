import{D as rt,F as at,R as ut,T as pt,U as ct,V as lt}from"./chunk-QX7X3HY2.js";import{a as X}from"./chunk-SATSLDLR.js";import{Z as dt,a as Y,c as Z,d as tt,e as et,f as it,g as nt,o as ot}from"./chunk-XF57MGBX.js";import{e as J}from"./chunk-GMXZDIJK.js";import{$b as D,Ab as Q,Bb as R,Cb as v,Db as o,Eb as r,Fb as g,Gb as y,Hb as l,I as q,K as N,Nb as $,Pb as b,Q as B,Qb as O,Rb as s,U as F,Ua as u,X as j,Y as z,Yb as L,_b as n,ac as m,ea as A,fa as _,fc as w,gb as d,hc as K,ic as H,k,ka as c,q as M,ra as V,sa as W,u as I,va as G,xb as C,yb as x,zb as U}from"./chunk-AGK5JNFR.js";var P=class{id;idCat;idType;idTypeNew;productionType;name;manufacturer;steelGrade;diameter;gost;profileSize2;pipeWallThickness;status;koef;constructor(t){this.id=t.id,this.idCat=t.idCat,this.idType=t.idType,this.idTypeNew=t.idTypeNew,this.productionType=this.getProductionType(t.productionType),this.name=t.name,this.manufacturer=t.manufacturer,this.steelGrade=t.steelGrade,this.diameter=t.diameter,this.profileSize2=t.profileSize2,this.pipeWallThickness=t.pipeWallThickness,this.status=this.getStatus(t.status),this.koef=t.koef,this.gost=t.gost}getStatus(t){return 0}getProductionType(t){return 0}};var f=class i extends X{constructor(){super("products")}static \u0275fac=function(e){return new(e||i)};static \u0275prov=_({token:i,factory:i.\u0275fac})};var st=[{id:"p1",idCat:"cat1",idType:"type1",idTypeNew:"typeNew1",productionType:"hot-rolled",name:"\u0422\u0440\u0443\u0431\u0430 \u0441\u0442\u0430\u043B\u044C\u043D\u0430\u044F 108x4",manufacturer:"\u0421\u0435\u0432\u0435\u0440\u0441\u0442\u0430\u043B\u044C",steelGrade:"09\u04132\u0421",diameter:108,gost:"\u0413\u041E\u0421\u0422 8732-78",profileSize2:0,pipeWallThickness:4,status:"active",koef:1.05},{id:"p2",idCat:"cat2",idType:"type2",idTypeNew:"typeNew2",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u0431\u0435\u0441\u0448\u043E\u0432\u043D\u0430\u044F 57x3,5",manufacturer:"\u0427\u0422\u041F\u0417",steelGrade:"20",diameter:57,gost:"\u0413\u041E\u0421\u0422 8734-75",profileSize2:0,pipeWallThickness:3.5,status:"inactive",koef:.98},{id:"p3",idCat:"cat1",idType:"type3",idTypeNew:"typeNew3",productionType:"welded",name:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C\u043D\u0430\u044F \u0442\u0440\u0443\u0431\u0430 60x40x3",manufacturer:"\u0422\u041C\u041A",steelGrade:"\u0421\u04423",diameter:60,gost:"\u0413\u041E\u0421\u0422 30245-2003",profileSize2:40,pipeWallThickness:3,status:"active",koef:1.1},{id:"p4",idCat:"cat3",idType:"type4",idTypeNew:"typeNew4",productionType:"hot-rolled",name:"\u041A\u0440\u0443\u0433 45",manufacturer:"\u041C\u0435\u0447\u0435\u043B",steelGrade:"45",diameter:45,gost:"\u0413\u041E\u0421\u0422 2590-2006",profileSize2:0,pipeWallThickness:0,status:"active",koef:1},{id:"p5",idCat:"cat2",idType:"type1",idTypeNew:"typeNew5",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u043E\u0446\u0438\u043D\u043A\u043E\u0432\u0430\u043D\u043D\u0430\u044F 25x2",manufacturer:"\u041E\u041C\u041A",steelGrade:"08\u042518\u041D10",diameter:25,gost:"\u0413\u041E\u0421\u0422 3262-75",profileSize2:0,pipeWallThickness:2,status:"archived",koef:.9}];var h=class i{api=c(f);filters$=new k({});products$=this.filters$.pipe(z(t=>M(st).pipe(I(e=>e.map(a=>new P(a))))),F(1));reload(t){this.filters$.next(t||{})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=_({token:i,factory:i.\u0275fac})};function gt(i,t){if(i&1&&(y(0,"div",4),n(1),l()),i&2){let e=s();u(),D(e.totalWeight)}}var E=class i{min=0;max=1/0;step=1;weightPerUnit;value=1;writeValue(t){this.value=t??this.min}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}decrease(){this.value>this.min&&this.updateValue(this.value-this.step)}increase(){this.value<this.max&&this.updateValue(this.value+this.step)}get totalWeight(){return this.weightPerUnit==null?null:(this.value*this.weightPerUnit).toFixed(3)+" \u0442"}updateValue(t){this.value=t,this.onChange(t),this.onTouched()}onChange=t=>{};onTouched=()=>{};static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["app-quantity"]],inputs:{min:"min",max:"max",step:"step",weightPerUnit:"weightPerUnit"},features:[w([{provide:Y,useExisting:A(()=>i),multi:!0}])],decls:9,vars:2,consts:[[1,"quantity-control"],["type","button",3,"click"],[1,"value-container"],[1,"value"],[1,"weight"]],template:function(e,a){e&1&&(y(0,"div",0)(1,"button",1),O("click",function(){return a.decrease()}),n(2,"\u2212"),l(),y(3,"div",2)(4,"div",3),n(5),l(),C(6,gt,2,1,"div",4),l(),y(7,"button",1),O("click",function(){return a.increase()}),n(8,"+"),l()()),e&2&&(u(5),D(a.value),u(),x(a.totalWeight?6:-1))},styles:[".quantity-control[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;background:#2c2c2c;color:#fff;border-radius:8px;padding:4px 8px;font-size:16px;width:100%}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:inherit;font-size:24px;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.quantity-control[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:40px}.quantity-control[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.quantity-control[_ngcontent-%COMP%]   .weight[_ngcontent-%COMP%]{font-size:12px;color:#fff9}"],changeDetection:0})};function yt(i,t){if(i&1&&g(0,"app-quantity",16),i&2){let e=s();v("formControl",e.quantityControl)}}var T=class i{destroyRef=c(G);cartService=c(lt);context=at();quantityControl=new tt(0,{nonNullable:!0});get product(){return this.context.data}get quantity(){return this.cartService.getQuantity(this.product.id)}ngOnInit(){this.quantityControl.patchValue(this.quantity,{emitEvent:!1}),this.quantityControl.valueChanges.pipe(j(this.quantity),B(),N((t,e)=>t[1]===e[1]),ot(this.destroyRef)).subscribe(([t,e])=>{if(e>t)this.cartService.addProduct(this.product,e-t);else if(e<t){let a=t-e;for(let p=0;p<a;p++)this.cartService.decreaseQuantity(this.product.id)}e===0&&this.cartService.removeProduct(this.product.id)})}pushToCart(){this.cartService.addProduct(this.product,1),this.quantityControl.patchValue(this.quantity,{emitEvent:!1})}openCart(){this.cartService.open()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["ng-component"]],decls:56,vars:9,consts:[[1,"product-overview"],[1,"product-overview__block"],["src","product.jpg",1,"product-overview__image",3,"alt"],[1,"product-overview__title"],[1,"product-overview__list"],[1,"product-overview__list-line"],[1,"product-overview__group"],[1,"product-overview__group-title"],[1,"product-overview__group-value"],[1,"product-overview__block-title"],[1,"product-overview__desc"],[1,"product-overview__desc-item"],[1,"product-overview__desc-title"],[1,"product-overview__desc-value"],[1,"product-overview__footer"],[3,"click"],[2,"width","30%",3,"formControl"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1),g(2,"img",2),o(3,"h3",3),n(4),r(),o(5,"div",4)(6,"div",5)(7,"div",6)(8,"span",7),n(9," \u041D\u0422\u0414 "),r(),o(10,"span",8),n(11),r()(),o(12,"div",6)(13,"span",7),n(14," \u0420\u0430\u0437\u043C\u0435\u0440 "),r(),o(15,"span",8),n(16),r()()(),o(17,"div",5)(18,"div",6)(19,"span",7),n(20," \u041C\u0430\u0440\u043A\u0430 \u0441\u0442\u0430\u043B\u0438 "),r(),o(21,"span",8),n(22),r()(),o(23,"div",6)(24,"span",7),n(25," \u0422\u043E\u043B\u0449\u0438\u043D\u0430 "),r(),o(26,"span",8),n(27),r()()()()(),o(28,"div",1)(29,"span",9),n(30," \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 "),r(),o(31,"div",10)(32,"div",11)(33,"span",12),n(34," \u041D\u0430\u043B\u0438\u0447\u0438\u0435 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 "),r(),o(35,"span",13),n(36," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(37,"div",11)(38,"span",12),n(39," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r(),o(40,"span",13),n(41," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(42,"div",11)(43,"span",12),n(44," \u0422\u0438\u043F \u043A\u043E\u043D\u0446\u043E\u0432 "),r(),o(45,"span",13),n(46," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(47,"div",11)(48,"span",12),n(49," \u041F\u0440\u0438\u0437\u043D\u0430\u043A \u0442\u0435\u0440\u043C\u043E\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 "),r(),o(50,"span",13),n(51," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()()()(),o(52,"div",14)(53,"app-button",15),b("click",function(){return a.quantity>0?a.openCart():a.pushToCart()}),n(54," \u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443 "),r(),C(55,yt,1,1,"app-quantity",16),r()()),e&2&&(u(2),v("alt",a.product.name),u(2),m(" ",a.product.name," "),u(7),m(" ",a.product.gost," "),u(5),m(" ",a.product.profileSize2," "),u(6),m(" ",a.product.steelGrade," "),u(5),m(" ",a.product.diameter," "),u(26),L("width",a.quantity>0?70:100,"%"),u(2),x(a.quantity>0?55:-1))},dependencies:[dt,E,nt,Z,et],styles:[".product-overview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.product-overview__block[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:15px;background-color:#2a2a2a;padding:12px;border-radius:12px}.product-overview__block-title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.product-overview__desc[_ngcontent-%COMP%]{max-width:335px;width:100%;display:flex;flex-wrap:wrap;font-weight:300}.product-overview__desc-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__desc-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__image[_ngcontent-%COMP%]{width:100%;border-radius:12px}.product-overview__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#fff}.product-overview__list[_ngcontent-%COMP%]{max-width:335px;width:100%;align-items:center;justify-content:center;color:#fff;display:flex;flex-direction:column;gap:20px;font-size:16px;font-weight:300}.product-overview__list-line[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.product-overview__group-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__footer[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}"],changeDetection:0})};function ht(i,t){if(i&1){let e=$();o(0,"app-product-card",6),b("click",function(){let p=V(e).$implicit,vt=s();return W(vt.openProduct(p))}),r()}if(i&2){let e=t.$implicit;v("product",e)}}var ft=class i{productsStore=c(h);dialog=ut(T,{dismissible:!0,label:"\u041E \u0442\u043E\u0432\u0430\u0440\u0435"});products$=this.productsStore.products$;openProduct(t){this.dialog(t).pipe(q(1)).subscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["ng-component"]],features:[w([h,f])],decls:9,vars:2,consts:[[1,"products-page"],[1,"products-page__search"],["placeholder","\u041F\u043E\u0438\u0441\u043A","iconStart","@tui.search",1,"products-page__search-input"],["appearance","secondary-destructive","iconStart","@tui.settings-2","size","l","tuiIconButton","","type","button",1,"products-page__search-action"],[1,"products-page__list"],[3,"product"],[3,"click","product"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1),g(2,"app-input",2),o(3,"button",3),n(4," Settings "),r()(),o(5,"div",4),Q(6,ht,1,1,"app-product-card",5,U),K(8,"async"),r()()),e&2&&(u(6),R(H(8,0,a.products$)))},dependencies:[pt,it,ct,rt,J],styles:[".products-page__list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(163px,1fr));gap:10px}.products-page__search[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:space-between;margin-bottom:24px}.products-page__search-input[_ngcontent-%COMP%]{width:100%}.products-page__search-action[_ngcontent-%COMP%]{color:#fff;border-radius:100%;border:1px solid #4C4E51}"],changeDetection:0})};export{ft as ProductsPageComponent};
