import{D as pt,F as ct,R as lt,T as st,U as ft}from"./chunk-WGA2S5DM.js";import{a as tt}from"./chunk-YNYD2DNC.js";import"./chunk-E5L4Z6T3.js";import{Y as dt,Z as mt,a as et,c as it,d as nt,e as ot,f as rt,g as at,o as ut}from"./chunk-O2YZ4WMB.js";import{Ab as o,Bb as r,Bc as Z,Cb as s,Db as C,Eb as g,I as B,K as z,Kb as H,Mb as h,Nb as D,Ob as l,Q as A,U as j,Ua as u,Vb as J,X as V,Xb as a,Y as W,Yb as I,Zb as _,cc as P,ea as G,eb as d,ec as X,fa as w,fc as Y,k as q,ka as m,q as N,ra as U,sa as Q,u as F,ub as f,va as R,vb as v,wb as $,xb as L,yb as K,zb as c}from"./chunk-M4MMIQ6G.js";function ht(i,t){if(i&1&&s(0,"tui-icon",1),i&2){let e=l();c("icon",e.iconStart)}}function _t(i,t){if(i&1&&s(0,"tui-icon",1),i&2){let e=l();c("icon",e.iconEnd)}}var S=class i{iconStart;iconEnd;placeholder;value="";disabled=!1;onChange=()=>{};onTouched=()=>{};writeValue(t){this.value=t??""}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["app-input"]],inputs:{iconStart:"iconStart",iconEnd:"iconEnd",placeholder:"placeholder"},decls:4,vars:5,consts:[[1,"icon-input"],[3,"icon"],["type","text",3,"input","blur","value","disabled","placeholder"]],template:function(e,n){e&1&&(o(0,"div",0),f(1,ht,1,1,"tui-icon",1),o(2,"input",2),h("input",function(M){return n.onChange(M.target.value)})("blur",function(){return n.onTouched()}),r(),f(3,_t,1,1,"tui-icon",1),r()),e&2&&(u(),v(n.iconStart?1:-1),u(),c("value",n.value)("disabled",n.disabled)("placeholder",n.placeholder),u(),v(n.iconEnd?3:-1))},dependencies:[dt],styles:[".icon-input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;border:1px solid #272829;transition:border-color .2s;border-radius:32px;background:#272829;color:#a0a2a8;padding:12px 16px}.icon-input[_ngcontent-%COMP%]:focus-within{border-color:#a0a2a8}.icon-input[_ngcontent-%COMP%]   i.start[_ngcontent-%COMP%]{margin-right:6px}.icon-input[_ngcontent-%COMP%]   i.end[_ngcontent-%COMP%]{margin-left:6px}.icon-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{line-height:20px;font-weight:400;border:none;outline:none;flex:1;background:transparent;color:#a0a2a8;font-size:16px}"],changeDetection:0})};var T=class{id;idCat;idType;idTypeNew;productionType;name;manufacturer;steelGrade;diameter;gost;profileSize2;pipeWallThickness;status;koef;constructor(t){this.id=t.id,this.idCat=t.idCat,this.idType=t.idType,this.idTypeNew=t.idTypeNew,this.productionType=this.getProductionType(t.productionType),this.name=t.name,this.manufacturer=t.manufacturer,this.steelGrade=t.steelGrade,this.diameter=t.diameter,this.profileSize2=t.profileSize2,this.pipeWallThickness=t.pipeWallThickness,this.status=this.getStatus(t.status),this.koef=t.koef,this.gost=t.gost}getStatus(t){return 0}getProductionType(t){return 0}};var y=class i extends tt{constructor(){super("products")}static \u0275fac=function(e){return new(e||i)};static \u0275prov=w({token:i,factory:i.\u0275fac})};var vt=[{id:"p1",idCat:"cat1",idType:"type1",idTypeNew:"typeNew1",productionType:"hot-rolled",name:"\u0422\u0440\u0443\u0431\u0430 \u0441\u0442\u0430\u043B\u044C\u043D\u0430\u044F 108x4",manufacturer:"\u0421\u0435\u0432\u0435\u0440\u0441\u0442\u0430\u043B\u044C",steelGrade:"09\u04132\u0421",diameter:108,gost:"\u0413\u041E\u0421\u0422 8732-78",profileSize2:0,pipeWallThickness:4,status:"active",koef:1.05},{id:"p2",idCat:"cat2",idType:"type2",idTypeNew:"typeNew2",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u0431\u0435\u0441\u0448\u043E\u0432\u043D\u0430\u044F 57x3,5",manufacturer:"\u0427\u0422\u041F\u0417",steelGrade:"20",diameter:57,gost:"\u0413\u041E\u0421\u0422 8734-75",profileSize2:0,pipeWallThickness:3.5,status:"inactive",koef:.98},{id:"p3",idCat:"cat1",idType:"type3",idTypeNew:"typeNew3",productionType:"welded",name:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C\u043D\u0430\u044F \u0442\u0440\u0443\u0431\u0430 60x40x3",manufacturer:"\u0422\u041C\u041A",steelGrade:"\u0421\u04423",diameter:60,gost:"\u0413\u041E\u0421\u0422 30245-2003",profileSize2:40,pipeWallThickness:3,status:"active",koef:1.1},{id:"p4",idCat:"cat3",idType:"type4",idTypeNew:"typeNew4",productionType:"hot-rolled",name:"\u041A\u0440\u0443\u0433 45",manufacturer:"\u041C\u0435\u0447\u0435\u043B",steelGrade:"45",diameter:45,gost:"\u0413\u041E\u0421\u0422 2590-2006",profileSize2:0,pipeWallThickness:0,status:"active",koef:1},{id:"p5",idCat:"cat2",idType:"type1",idTypeNew:"typeNew5",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u043E\u0446\u0438\u043D\u043A\u043E\u0432\u0430\u043D\u043D\u0430\u044F 25x2",manufacturer:"\u041E\u041C\u041A",steelGrade:"08\u042518\u041D10",diameter:25,gost:"\u0413\u041E\u0421\u0422 3262-75",profileSize2:0,pipeWallThickness:2,status:"archived",koef:.9}];var x=class i{api=m(y);filters$=new q({});products$=this.filters$.pipe(W(t=>N(vt).pipe(F(e=>e.map(n=>new T(n))))),j(1));reload(t){this.filters$.next(t||{})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=w({token:i,factory:i.\u0275fac})};function yt(i,t){if(i&1&&(C(0,"div",4),a(1),g()),i&2){let e=l();u(),I(e.totalWeight)}}var E=class i{min=0;max=1/0;step=1;weightPerUnit;value=1;writeValue(t){this.value=t??this.min}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}decrease(){this.value>this.min&&this.updateValue(this.value-this.step)}increase(){this.value<this.max&&this.updateValue(this.value+this.step)}get totalWeight(){return this.weightPerUnit==null?null:(this.value*this.weightPerUnit).toFixed(3)+" \u0442"}updateValue(t){this.value=t,this.onChange(t),this.onTouched()}onChange=t=>{};onTouched=()=>{};static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["app-quantity"]],inputs:{min:"min",max:"max",step:"step",weightPerUnit:"weightPerUnit"},features:[P([{provide:et,useExisting:G(()=>i),multi:!0}])],decls:9,vars:2,consts:[[1,"quantity-control"],["type","button",3,"click"],[1,"value-container"],[1,"value"],[1,"weight"]],template:function(e,n){e&1&&(C(0,"div",0)(1,"button",1),D("click",function(){return n.decrease()}),a(2,"\u2212"),g(),C(3,"div",2)(4,"div",3),a(5),g(),f(6,yt,2,1,"div",4),g(),C(7,"button",1),D("click",function(){return n.increase()}),a(8,"+"),g()()),e&2&&(u(5),I(n.value),u(),v(n.totalWeight?6:-1))},styles:[".quantity-control[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;background:#2c2c2c;color:#fff;border-radius:8px;padding:4px 8px;font-size:16px;width:100%}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:inherit;font-size:24px;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.quantity-control[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:40px}.quantity-control[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.quantity-control[_ngcontent-%COMP%]   .weight[_ngcontent-%COMP%]{font-size:12px;color:#fff9}"],changeDetection:0})};function Ct(i,t){if(i&1&&s(0,"app-quantity",16),i&2){let e=l();c("formControl",e.quantityControl)}}var O=class i{destroyRef=m(R);cartService=m(ft);context=ct();quantityControl=new nt(0,{nonNullable:!0});get product(){return this.context.data}get quantity(){return this.cartService.getQuantity(this.product.id)}ngOnInit(){this.quantityControl.patchValue(this.quantity,{emitEvent:!1}),this.quantityControl.valueChanges.pipe(V(this.quantity),A(),z((t,e)=>t[1]===e[1]),ut(this.destroyRef)).subscribe(([t,e])=>{if(e>t)this.cartService.addProduct(this.product,e-t);else if(e<t){let n=t-e;for(let p=0;p<n;p++)this.cartService.decreaseQuantity(this.product.id)}e===0&&this.cartService.removeProduct(this.product.id)})}pushToCart(){this.cartService.addProduct(this.product,1),this.quantityControl.patchValue(this.quantity,{emitEvent:!1})}openCart(){this.cartService.open()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["ng-component"]],decls:56,vars:9,consts:[[1,"product-overview"],[1,"product-overview__block"],["src","product.jpg",1,"product-overview__image",3,"alt"],[1,"product-overview__title"],[1,"product-overview__list"],[1,"product-overview__list-line"],[1,"product-overview__group"],[1,"product-overview__group-title"],[1,"product-overview__group-value"],[1,"product-overview__block-title"],[1,"product-overview__desc"],[1,"product-overview__desc-item"],[1,"product-overview__desc-title"],[1,"product-overview__desc-value"],[1,"product-overview__footer"],[3,"click"],[2,"width","30%",3,"formControl"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),s(2,"img",2),o(3,"h3",3),a(4),r(),o(5,"div",4)(6,"div",5)(7,"div",6)(8,"span",7),a(9," \u041D\u0422\u0414 "),r(),o(10,"span",8),a(11),r()(),o(12,"div",6)(13,"span",7),a(14," \u0420\u0430\u0437\u043C\u0435\u0440 "),r(),o(15,"span",8),a(16),r()()(),o(17,"div",5)(18,"div",6)(19,"span",7),a(20," \u041C\u0430\u0440\u043A\u0430 \u0441\u0442\u0430\u043B\u0438 "),r(),o(21,"span",8),a(22),r()(),o(23,"div",6)(24,"span",7),a(25," \u0422\u043E\u043B\u0449\u0438\u043D\u0430 "),r(),o(26,"span",8),a(27),r()()()()(),o(28,"div",1)(29,"span",9),a(30," \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 "),r(),o(31,"div",10)(32,"div",11)(33,"span",12),a(34," \u041D\u0430\u043B\u0438\u0447\u0438\u0435 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 "),r(),o(35,"span",13),a(36," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(37,"div",11)(38,"span",12),a(39," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r(),o(40,"span",13),a(41," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(42,"div",11)(43,"span",12),a(44," \u0422\u0438\u043F \u043A\u043E\u043D\u0446\u043E\u0432 "),r(),o(45,"span",13),a(46," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()(),o(47,"div",11)(48,"span",12),a(49," \u041F\u0440\u0438\u0437\u043D\u0430\u043A \u0442\u0435\u0440\u043C\u043E\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 "),r(),o(50,"span",13),a(51," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),r()()()(),o(52,"div",14)(53,"app-button",15),h("click",function(){return n.quantity>0?n.openCart():n.pushToCart()}),a(54," \u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443 "),r(),f(55,Ct,1,1,"app-quantity",16),r()()),e&2&&(u(2),c("alt",n.product.name),u(2),_(" ",n.product.name," "),u(7),_(" ",n.product.gost," "),u(5),_(" ",n.product.profileSize2," "),u(6),_(" ",n.product.steelGrade," "),u(5),_(" ",n.product.diameter," "),u(26),J("width",n.quantity>0?70:100,"%"),u(2),v(n.quantity>0?55:-1))},dependencies:[mt,E,at,it,ot],styles:[".product-overview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.product-overview__block[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:15px;background-color:#2a2a2a;padding:12px;border-radius:12px}.product-overview__block-title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.product-overview__desc[_ngcontent-%COMP%]{max-width:335px;width:100%;display:flex;flex-wrap:wrap;font-weight:300}.product-overview__desc-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__desc-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__image[_ngcontent-%COMP%]{width:100%;border-radius:12px}.product-overview__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#fff}.product-overview__list[_ngcontent-%COMP%]{max-width:335px;width:100%;align-items:center;justify-content:center;color:#fff;display:flex;flex-direction:column;gap:20px;font-size:16px;font-weight:300}.product-overview__list-line[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.product-overview__group-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__footer[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}"],changeDetection:0})};function bt(i,t){if(i&1){let e=H();o(0,"app-product-card",6),h("click",function(){let p=U(e).$implicit,M=l();return Q(M.openProduct(p))}),r()}if(i&2){let e=t.$implicit;c("product",e)}}var gt=class i{productsStore=m(x);dialog=lt(O,{dismissible:!0,label:"\u041E \u0442\u043E\u0432\u0430\u0440\u0435"});products$=this.productsStore.products$;openProduct(t){this.dialog(t).pipe(B(1)).subscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=d({type:i,selectors:[["ng-component"]],features:[P([x,y])],decls:9,vars:2,consts:[[1,"products-page"],[1,"products-page__search"],["placeholder","\u041F\u043E\u0438\u0441\u043A","iconStart","@tui.search",1,"products-page__search-input"],["appearance","secondary-destructive","iconStart","@tui.settings-2","size","l","tuiIconButton","","type","button",1,"products-page__search-action"],[1,"products-page__list"],[3,"product"],[3,"click","product"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),s(2,"app-input",2),o(3,"button",3),a(4," Settings "),r()(),o(5,"div",4),L(6,bt,1,1,"app-product-card",5,$),X(8,"async"),r()()),e&2&&(u(6),K(Y(8,0,n.products$)))},dependencies:[st,rt,S,pt,Z],styles:[".products-page__list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(163px,1fr));gap:10px}.products-page__search[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:space-between;margin-bottom:24px}.products-page__search-input[_ngcontent-%COMP%]{width:100%}.products-page__search-action[_ngcontent-%COMP%]{color:#fff;border-radius:100%;border:1px solid #4C4E51}"],changeDetection:0})};export{gt as ProductsPageComponent};
