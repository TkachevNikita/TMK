import{D as J,F as X,R as B}from"./chunk-MEDXAACF.js";import{a as Ee}from"./chunk-VSCH4U2L.js";import{a as Y,b as q}from"./chunk-5DLHAAAV.js";import{a as Oe,c as K,d as Se,e as Me,f as De,g as H,h as Te,p as Ie}from"./chunk-DZKLHA53.js";import{e as k,p as Pe}from"./chunk-YXM4UVJP.js";import{$b as y,Ab as S,Bb as M,Cb as _,Db as i,Eb as o,Fb as d,Gb as z,Hb as D,I as E,K as pe,Mb as h,Ob as s,Pb as ae,Q as de,Qb as m,U as le,Ua as c,X as se,Xb as G,Y as me,Yb as ve,Zb as a,_b as ue,a as oe,ac as Ce,b as re,bc as xe,cc as he,dc as ye,ea as fe,ec as U,fa as O,fc as be,gb as l,gc as we,hc as L,jc as T,k as j,ka as f,kc as I,ob as R,q as ce,ra as C,sa as x,u as Q,va as _e,xb as g,yb as v,zb as ge}from"./chunk-UC5AGK5J.js";function qe(n,e){if(n&1){let t=h();i(0,"div",5)(1,"button",9),s("click",function(){C(t);let u=m();return x(u.removeItem())}),a(2," remove "),o()()}}var F=class n{product;direction="column";editMode=!1;remove=new R;removeItem(){this.remove.emit()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["app-product-card"]],inputs:{product:"product",direction:"direction",editMode:"editMode"},outputs:{remove:"remove"},decls:12,vars:4,consts:[[1,"product-card"],["src","product.jpg","alt",`product
`,1,"product-card__image"],[1,"product-card__desc"],[1,"product-card__desc-head"],[1,"product-card__title"],[1,"product-card__delete"],[1,"product-card__price"],[1,"product-card__price-value"],[1,"product-card__price-text"],["appearance","secondary-destructive","iconStart","@tui.trash","size","s","tuiIconButton","","type","button",3,"click"]],template:function(t,r){t&1&&(i(0,"div",0),d(1,"img",1),i(2,"div",2)(3,"div",3)(4,"span",4),a(5),o(),g(6,qe,3,0,"div",5),o(),i(7,"div",6)(8,"span",7),a(9," 355 028,40 \u20BD "),o(),i(10,"div",8),a(11," \u0426\u0435\u043D\u0430 \u0437\u0430 \u0442\u043E\u043D\u043D\u0443 \u0441 \u043D\u0434\u0441 "),o()()()()),t&2&&(ve("product-card__row",r.direction==="row"),c(5),y(" ",r.product.name," "),c(),v(r.editMode?6:-1))},dependencies:[J],styles:[".product-card[_ngcontent-%COMP%]{cursor:pointer;background-color:#2f2f2f;width:100%;height:100%;border-radius:12px;display:flex;flex-direction:column}.product-card__row[_ngcontent-%COMP%]{flex-direction:row}.product-card__image[_ngcontent-%COMP%]{border-radius:12px;height:164px}.product-card__title[_ngcontent-%COMP%]{color:#fff;font-size:16px;font-weight:300}.product-card__desc[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;justify-content:space-between;gap:10px;width:100%}.product-card__desc-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}.product-card__price-value[_ngcontent-%COMP%]{color:#fff;font-weight:500;font-size:20px}.product-card__price-text[_ngcontent-%COMP%]{font-weight:300;font-size:11px;color:#939393}@media (max-width: 600px){.product-card__row[_ngcontent-%COMP%]   .product-card__image[_ngcontent-%COMP%]{max-width:160px}}"],changeDetection:0})};function Fe(n,e){if(n&1&&d(0,"tui-icon",1),n&2){let t=m();_("icon",t.iconStart)}}function $e(n,e){if(n&1&&d(0,"tui-icon",1),n&2){let t=m();_("icon",t.iconEnd)}}var $=class n{iconStart;iconEnd;placeholder;value="";disabled=!1;onChange=()=>{};onTouched=()=>{};writeValue(e){this.value=e??""}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["app-input"]],inputs:{iconStart:"iconStart",iconEnd:"iconEnd",placeholder:"placeholder"},decls:4,vars:5,consts:[[1,"icon-input"],[3,"icon"],["type","text",3,"input","blur","value","disabled","placeholder"]],template:function(t,r){t&1&&(i(0,"div",0),g(1,Fe,1,1,"tui-icon",1),i(2,"input",2),s("input",function(p){return r.onChange(p.target.value)})("blur",function(){return r.onTouched()}),o(),g(3,$e,1,1,"tui-icon",1),o()),t&2&&(c(),v(r.iconStart?1:-1),c(),_("value",r.value)("disabled",r.disabled)("placeholder",r.placeholder),c(),v(r.iconEnd?3:-1))},dependencies:[Y],styles:[".icon-input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;border:1px solid #272829;transition:border-color .2s;border-radius:32px;background:#272829;color:#a0a2a8;padding:12px 16px}.icon-input[_ngcontent-%COMP%]:focus-within{border-color:#a0a2a8}.icon-input[_ngcontent-%COMP%]   i.start[_ngcontent-%COMP%]{margin-right:6px}.icon-input[_ngcontent-%COMP%]   i.end[_ngcontent-%COMP%]{margin-left:6px}.icon-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{line-height:20px;font-weight:400;border:none;outline:none;flex:1;background:transparent;color:#a0a2a8;font-size:16px}"],changeDetection:0})};var Z=class{id;idCat;idType;idTypeNew;productionType;name;manufacturer;steelGrade;diameter;gost;profileSize2;pipeWallThickness;status;koef;constructor(e){this.id=e.id,this.idCat=e.idCat,this.idType=e.idType,this.idTypeNew=e.idTypeNew,this.productionType=this.getProductionType(e.productionType),this.name=e.name,this.manufacturer=e.manufacturer,this.steelGrade=e.steelGrade,this.diameter=e.diameter,this.profileSize2=e.profileSize2,this.pipeWallThickness=e.pipeWallThickness,this.status=this.getStatus(e.status),this.koef=e.koef,this.gost=e.gost}getStatus(e){return 0}getProductionType(e){return 0}};var A=class n extends Ee{constructor(){super("products")}static \u0275fac=function(t){return new(t||n)};static \u0275prov=O({token:n,factory:n.\u0275fac})};var ke=[{id:"p1",idCat:"cat1",idType:"type1",idTypeNew:"typeNew1",productionType:"hot-rolled",name:"\u0422\u0440\u0443\u0431\u0430 \u0441\u0442\u0430\u043B\u044C\u043D\u0430\u044F 108x4",manufacturer:"\u0421\u0435\u0432\u0435\u0440\u0441\u0442\u0430\u043B\u044C",steelGrade:"09\u04132\u0421",diameter:108,gost:"\u0413\u041E\u0421\u0422 8732-78",profileSize2:0,pipeWallThickness:4,status:"active",koef:1.05},{id:"p2",idCat:"cat2",idType:"type2",idTypeNew:"typeNew2",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u0431\u0435\u0441\u0448\u043E\u0432\u043D\u0430\u044F 57x3,5",manufacturer:"\u0427\u0422\u041F\u0417",steelGrade:"20",diameter:57,gost:"\u0413\u041E\u0421\u0422 8734-75",profileSize2:0,pipeWallThickness:3.5,status:"inactive",koef:.98},{id:"p3",idCat:"cat1",idType:"type3",idTypeNew:"typeNew3",productionType:"welded",name:"\u041F\u0440\u043E\u0444\u0438\u043B\u044C\u043D\u0430\u044F \u0442\u0440\u0443\u0431\u0430 60x40x3",manufacturer:"\u0422\u041C\u041A",steelGrade:"\u0421\u04423",diameter:60,gost:"\u0413\u041E\u0421\u0422 30245-2003",profileSize2:40,pipeWallThickness:3,status:"active",koef:1.1},{id:"p4",idCat:"cat3",idType:"type4",idTypeNew:"typeNew4",productionType:"hot-rolled",name:"\u041A\u0440\u0443\u0433 45",manufacturer:"\u041C\u0435\u0447\u0435\u043B",steelGrade:"45",diameter:45,gost:"\u0413\u041E\u0421\u0422 2590-2006",profileSize2:0,pipeWallThickness:0,status:"active",koef:1},{id:"p5",idCat:"cat2",idType:"type1",idTypeNew:"typeNew5",productionType:"cold-drawn",name:"\u0422\u0440\u0443\u0431\u0430 \u043E\u0446\u0438\u043D\u043A\u043E\u0432\u0430\u043D\u043D\u0430\u044F 25x2",manufacturer:"\u041E\u041C\u041A",steelGrade:"08\u042518\u041D10",diameter:25,gost:"\u0413\u041E\u0421\u0422 3262-75",profileSize2:0,pipeWallThickness:2,status:"archived",koef:.9}];var V=class n{api=f(A);filters$=new j({});products$=this.filters$.pipe(me(e=>ce(ke).pipe(Q(t=>t.map(r=>new Z(r))))),le(1));reload(e){this.filters$.next(e||{})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=O({token:n,factory:n.\u0275fac})};function Ae(n,e){if(n&1&&(z(0,"div",4),a(1),D()),n&2){let t=m();c(),ue(t.totalWeight)}}var N=class n{min=0;max=1/0;step=1;weightPerUnit;change=new R;value=1;writeValue(e){this.value=e??this.min}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}decrease(){this.value>this.min&&this.updateValue(this.value-this.step)}increase(){this.value<this.max&&this.updateValue(this.value+this.step)}get totalWeight(){return this.weightPerUnit==null?null:(this.value*this.weightPerUnit).toFixed(3)+" \u0442"}updateValue(e){this.value=e,this.change.emit(e),this.onChange(e),this.onTouched()}onChange=e=>{};onTouched=()=>{};static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["app-quantity"]],inputs:{min:"min",max:"max",step:"step",weightPerUnit:"weightPerUnit"},outputs:{change:"change"},features:[L([{provide:Oe,useExisting:fe(()=>n),multi:!0}])],decls:9,vars:2,consts:[[1,"quantity-control"],["type","button",3,"click"],[1,"value-container"],[1,"value"],[1,"weight"]],template:function(t,r){t&1&&(z(0,"div",0)(1,"button",1),ae("click",function(){return r.decrease()}),a(2,"\u2212"),D(),z(3,"div",2)(4,"div",3),a(5),D(),g(6,Ae,2,1,"div",4),D(),z(7,"button",1),ae("click",function(){return r.increase()}),a(8,"+"),D()()),t&2&&(c(5),ue(r.value),c(),v(r.totalWeight?6:-1))},styles:[".quantity-control[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;background:#2c2c2c;color:#fff;border-radius:50px;padding:4px 8px;font-size:16px;width:100%;height:100%}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:inherit;font-size:24px;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.quantity-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.quantity-control[_ngcontent-%COMP%]   .value-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:40px}.quantity-control[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.quantity-control[_ngcontent-%COMP%]   .weight[_ngcontent-%COMP%]{font-size:12px;color:#fff9}"],changeDetection:0})};var ee=class n{cartService=f(w);item;updateQuantity(e){e===0&&this.cartService.removeProduct(this.item.product.id)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["app-order-product"]],inputs:{item:"item"},decls:7,vars:3,consts:[[1,"order-product"],[1,"order-product__img"],["src","product.jpg","alt","product"],[1,"order-product__body"],[1,"order-product__quantity",3,"change","ngModelChange","ngModel"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1),d(2,"img",2),o(),i(3,"div",3)(4,"p"),a(5),o(),i(6,"app-quantity",4),s("change",function(p){return r.updateQuantity(p)}),ye("ngModelChange",function(p){return he(r.item.quantity,p)||(r.item.quantity=p),p}),o()()()),t&2&&(c(5),Ce("",r.item.product.name,", D ",r.item.product.profileSize2," \u043C"),c(),xe("ngModel",r.item.quantity))},dependencies:[N,H,K,Me],styles:[".order-product[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;border:1px solid #535353;border-radius:12px;gap:12px}.order-product__body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;gap:10px}.order-product[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-right:12px}.order-product__img[_ngcontent-%COMP%]{max-width:80px;height:80px;border-radius:12px;overflow:hidden}.order-product__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}"],changeDetection:0})};var je=(n,e)=>e.product.id;function ze(n,e){if(n&1&&d(0,"app-order-product",13),n&2){let t=e.$implicit;_("item",t)}}var te=class n{cartService=f(w);createOrder(){}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["ng-component"]],decls:47,vars:3,consts:[[1,"order"],[1,"box"],[1,"title"],[1,"inputs"],[1,"input-container"],["placeholder","\u0424\u0418\u041E",1,"order-input",2,"border-radius","2px"],["placeholder","\u0418\u041D\u041D",1,"order-input",2,"border-radius","2px"],["placeholder","\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043E\u0440\u0433\u0430\u043D\u0438\u0437\u0430\u0446\u0438\u0438",1,"order-input",2,"border-radius","2px"],["placeholder","\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",1,"order-input",2,"border-radius","2px"],["placeholder","Email",1,"order-input",2,"border-radius","2px"],[1,"info-order"],[1,"info-order__row"],[1,"order-products"],[3,"item"],[1,"design"],[1,"sale"],[3,"click","disabled"]],template:function(t,r){if(t&1){let u=h();U(0),T(1,"async"),i(2,"div",0)(3,"div",1)(4,"h2",2),a(5,"\u0414\u0430\u043D\u043D\u044B\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0442\u0435\u043B\u044F"),o(),i(6,"div",3)(7,"div",4),d(8,"app-input",5),o(),i(9,"div",4),d(10,"app-input",6),o(),i(11,"div",4),d(12,"app-input",7),o(),i(13,"div",4),d(14,"app-input",8),o(),i(15,"div",4),d(16,"app-input",9),o()()(),i(17,"div",1)(18,"h2",2),a(19,"\u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437"),o(),i(20,"div",10)(21,"div",11)(22,"p"),a(23,"2 \u0442\u043E\u0432\u0430\u0440\u0430"),o(),i(24,"span"),a(25,"21 131,09 \u20BD"),o()(),i(26,"div",11)(27,"p"),a(28,"\u0421\u043A\u0438\u0434\u043A\u0430"),o(),i(29,"span"),a(30,"-1 840 \u20BD"),o()(),i(31,"div",11)(32,"p"),a(33,"\u0418\u0442\u043E\u0433\u043E"),o(),i(34,"span"),a(35,"19 291,09 \u20BD"),o()()(),i(36,"div",12),S(37,ze,1,1,"app-order-product",13,je),o()(),i(39,"div",14)(40,"div",15)(41,"p"),a(42,"\u0426\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439"),o(),i(43,"span"),a(44,"19 291,09 \u20BD"),o()(),i(45,"app-button",16),s("click",function(){return C(u),x(r.createOrder())}),a(46," \u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0443 "),o()()()}if(t&2){let u=I(1,1,r.cartService.items$);c(37),M(u),c(8),_("disabled",(u==null?null:u.length)===0)}},dependencies:[$,q,ee,k],styles:[".order[_ngcontent-%COMP%]{margin-top:24px;display:flex;flex-direction:column;gap:20px}.box[_ngcontent-%COMP%]{background-color:#2a2a2a;border-radius:12px;padding:12px}.title[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.input-container[_ngcontent-%COMP%]{border:1px solid #484A4D;border-radius:25px}.inputs[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-direction:column;row-gap:12px}.info-order[_ngcontent-%COMP%]{margin-top:12px;display:flex;flex-direction:column;gap:6px}.info-order__row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.info-order__row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17px;color:#b0b0b0;font-weight:300}.order-products[_ngcontent-%COMP%]{margin-top:16px;display:flex;flex-direction:column;gap:16px}.order-product[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #535353;border-radius:12px;gap:12px}.order-product[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-right:12px}.order-product__img[_ngcontent-%COMP%]{max-width:80px;height:80px;border-radius:12px;overflow:hidden}.order-product__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.sale[_ngcontent-%COMP%]{margin-top:12px;display:flex;align-items:center;justify-content:space-between}.sale[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17px;color:#b0b0b0;font-weight:300}.sale[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;color:#fff;font-weight:500}.design[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}"],changeDetection:0})};var Ve=(n,e)=>e.product.id;function We(n,e){n&1&&(i(0,"div",1),d(1,"tui-icon",3),i(2,"span",4),a(3," \u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0435 \u043F\u0443\u0441\u0442\u043E "),o(),i(4,"span",5),a(5," \u041F\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432 \u043A\u0430\u0442\u0430\u043B\u043E\u0433 \u0434\u043B\u044F \u0432\u044B\u0431\u043E\u0440\u0430 "),o()()),n&2&&(c(),G("font-size",72,"px"))}function Qe(n,e){if(n&1){let t=h();i(0,"app-product-card",14),s("remove",function(){let u=C(t).$implicit,p=m(2);return x(p.removeItem(u.product.id))}),o()}if(n&2){let t=e.$implicit;_("editMode",!0)("product",t.product)}}function Re(n,e){if(n&1&&(i(0,"div",6),S(1,Qe,1,2,"app-product-card",7,Ve),o(),i(3,"div",8)(4,"span",9),a(5," \u0412\u0430\u0448 \u0437\u0430\u043A\u0430\u0437 "),o(),i(6,"div",10)(7,"div",11)(8,"span",12),a(9),o(),i(10,"span",13),a(11," 343 \u20BD "),o()(),i(12,"div",11)(13,"span",12),a(14," \u0421\u043A\u0438\u0434\u043A\u0430 "),o(),i(15,"span",13),a(16," -343 \u20BD "),o()(),i(17,"div",11)(18,"span",12),a(19," \u0426\u0435\u043D\u0430 \u0441\u043E \u0441\u043A\u0438\u0434\u043A\u043E\u0439 "),o(),i(20,"span",13),a(21," 0 \u20BD "),o()()()()),n&2){m();let t=we(0);c(),M(t),c(8),y(" \u0422\u043E\u0432\u0430\u0440\u043E\u0432 ",t==null?null:t.length," ")}}function Ge(n,e){if(n&1){let t=h();i(0,"app-button",15),s("click",function(){C(t);let u=m();return x(u.getOrder())}),a(1," \u041E\u0444\u043E\u0440\u043C\u0438\u0442\u044C "),o()}}function Ue(n,e){if(n&1){let t=h();i(0,"app-button",15),s("click",function(){C(t);let u=m();return x(u.navigateToCategories())}),a(1," \u041A\u0430\u0442\u0430\u043B\u043E\u0433 "),o()}}var ie=class n{context=X();router=f(Pe);cartService=f(w);dialog=B(te,{dismissible:!0,label:"\u041E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430"});items$=this.cartService.items$;navigateToCategories(){this.context.completeWith(),this.router.navigate(["/categories"])}getOrder(){this.context.completeWith(),this.dialog().pipe(E(1)).subscribe()}removeItem(e){this.cartService.removeProduct(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["ng-component"]],decls:8,vars:5,consts:[[1,"cart"],[1,"cart__empty"],[1,"cart__footer"],["icon","@tui.shopping-cart"],[1,"cart__empty-title"],[1,"cart__empty-text"],[1,"cart__list"],["direction","row",3,"editMode","product"],[1,"cart__overview"],[1,"cart__overview-title"],[1,"cart__overview-list"],[1,"cart__overview-info"],[1,"cart__overview-info-title"],[1,"cart__overview-info-value"],["direction","row",3,"remove","editMode","product"],[3,"click"]],template:function(t,r){if(t&1&&(U(0),T(1,"async"),i(2,"div",0),g(3,We,6,2,"div",1)(4,Re,22,1),i(5,"div",2),g(6,Ge,2,0,"app-button")(7,Ue,2,0,"app-button"),o()()),t&2){let u=be(I(1,2,r.items$));c(3),v((u==null?null:u.length)===0?3:4),c(3),v(u.length>0?6:7)}},dependencies:[F,q,Y,k],styles:[".cart[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;margin-top:40px}.cart__list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.cart__overview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;padding:12px;background-color:#2a2a2a;color:#f8f8f8;border-radius:12px}.cart__overview-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;font-weight:300;font-size:16px}.cart__overview-title[_ngcontent-%COMP%]{font-size:16px;font-weight:500}.cart__overview-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.cart__overview-info-title[_ngcontent-%COMP%]{color:#b0b0b0}.cart__empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}.cart__empty-title[_ngcontent-%COMP%]{font-weight:500;font-size:24px}.cart__empty-text[_ngcontent-%COMP%]{font-weight:400;font-size:18px;color:#d0d0d0}.product-card__image[_ngcontent-%COMP%]{max-width:120px}"],changeDetection:0})};var w=class n{dialog=B(ie,{dismissible:!0,label:"\u041A\u043E\u0440\u0437\u0438\u043D\u0430"});cartOpen$=new j(!1);cartItems$=new j([]);isOpen$=this.cartOpen$.asObservable();items$=this.cartItems$.asObservable();open(){this.cartOpen$.next(!0),this.dialog().pipe(E(1)).subscribe({next:()=>{},complete:()=>{this.cartOpen$.next(!1)}})}addProduct(e,t=1){let r=this.cartItems$.value;if(r.find(p=>p.product.id===e.id)){let p=r.map(W=>W.product.id===e.id?re(oe({},W),{quantity:W.quantity+t}):W);this.cartItems$.next(p)}else this.cartItems$.next([...r,{product:e,quantity:t}])}decreaseQuantity(e){let t=this.cartItems$.value,r=t.find(u=>u.product.id===e);if(r)if(r.quantity>1){let u=t.map(p=>p.product.id===e?re(oe({},p),{quantity:p.quantity-1}):p);this.cartItems$.next(u)}else this.removeProduct(e)}removeProduct(e){let t=this.cartItems$.value.filter(r=>r.product.id!==e);this.cartItems$.next(t)}clear(){this.cartItems$.next([])}getQuantity(e){return this.cartItems$.value.find(t=>t.product.id===e)?.quantity??0}get itemCount(){return this.cartItems$.value.length}get totalQuantity(){return this.items$.pipe(Q(e=>e.reduce((t,r)=>t+r.quantity,0)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=O({token:n,factory:n.\u0275fac,providedIn:"root"})};function Le(n,e){if(n&1&&d(0,"app-quantity",16),n&2){let t=m();_("formControl",t.quantityControl)}}var ne=class n{destroyRef=f(_e);cartService=f(w);context=X();quantityControl=new Se(0,{nonNullable:!0});get product(){return this.context.data}get quantity(){return this.cartService.getQuantity(this.product.id)}ngOnInit(){this.quantityControl.patchValue(this.quantity,{emitEvent:!1}),this.quantityControl.valueChanges.pipe(se(this.quantity),de(),pe((e,t)=>e[1]===t[1]),Ie(this.destroyRef)).subscribe(([e,t])=>{if(t>e)this.cartService.addProduct(this.product,t-e);else if(t<e){let r=e-t;for(let u=0;u<r;u++)this.cartService.decreaseQuantity(this.product.id)}t===0&&this.cartService.removeProduct(this.product.id)})}pushToCart(){this.cartService.addProduct(this.product,1),this.quantityControl.patchValue(this.quantity,{emitEvent:!1})}openCart(){this.cartService.open()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["ng-component"]],decls:56,vars:9,consts:[[1,"product-overview"],[1,"product-overview__block"],["src","product.jpg",1,"product-overview__image",3,"alt"],[1,"product-overview__title"],[1,"product-overview__list"],[1,"product-overview__list-line"],[1,"product-overview__group"],[1,"product-overview__group-title"],[1,"product-overview__group-value"],[1,"product-overview__block-title"],[1,"product-overview__desc"],[1,"product-overview__desc-item"],[1,"product-overview__desc-title"],[1,"product-overview__desc-value"],[1,"product-overview__footer"],[3,"click"],[2,"width","30%",3,"formControl"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1),d(2,"img",2),i(3,"h3",3),a(4),o(),i(5,"div",4)(6,"div",5)(7,"div",6)(8,"span",7),a(9," \u041D\u0422\u0414 "),o(),i(10,"span",8),a(11),o()(),i(12,"div",6)(13,"span",7),a(14," \u0420\u0430\u0437\u043C\u0435\u0440 "),o(),i(15,"span",8),a(16),o()()(),i(17,"div",5)(18,"div",6)(19,"span",7),a(20," \u041C\u0430\u0440\u043A\u0430 \u0441\u0442\u0430\u043B\u0438 "),o(),i(21,"span",8),a(22),o()(),i(23,"div",6)(24,"span",7),a(25," \u0422\u043E\u043B\u0449\u0438\u043D\u0430 "),o(),i(26,"span",8),a(27),o()()()()(),i(28,"div",1)(29,"span",9),a(30," \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 "),o(),i(31,"div",10)(32,"div",11)(33,"span",12),a(34," \u041D\u0430\u043B\u0438\u0447\u0438\u0435 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 "),o(),i(35,"span",13),a(36," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),o()(),i(37,"div",11)(38,"span",12),a(39," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),o(),i(40,"span",13),a(41," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),o()(),i(42,"div",11)(43,"span",12),a(44," \u0422\u0438\u043F \u043A\u043E\u043D\u0446\u043E\u0432 "),o(),i(45,"span",13),a(46," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),o()(),i(47,"div",11)(48,"span",12),a(49," \u041F\u0440\u0438\u0437\u043D\u0430\u043A \u0442\u0435\u0440\u043C\u043E\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 "),o(),i(50,"span",13),a(51," \u041C\u0435\u0440\u043D\u043E\u0441\u0442\u044C \u0434\u043B\u0438\u043D\u044B "),o()()()(),i(52,"div",14)(53,"app-button",15),s("click",function(){return r.quantity>0?r.openCart():r.pushToCart()}),a(54," \u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443 "),o(),g(55,Le,1,1,"app-quantity",16),o()()),t&2&&(c(2),_("alt",r.product.name),c(2),y(" ",r.product.name," "),c(7),y(" ",r.product.gost," "),c(5),y(" ",r.product.profileSize2," "),c(6),y(" ",r.product.steelGrade," "),c(5),y(" ",r.product.diameter," "),c(26),G("width",r.quantity>0?70:100,"%"),c(2),v(r.quantity>0?55:-1))},dependencies:[q,N,Te,K,De],styles:[".product-overview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.product-overview__block[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:15px;background-color:#2a2a2a;padding:12px;border-radius:12px}.product-overview__block-title[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.product-overview__desc[_ngcontent-%COMP%]{max-width:335px;width:100%;display:flex;flex-wrap:wrap;font-weight:300}.product-overview__desc-item[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__desc-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__image[_ngcontent-%COMP%]{width:100%;border-radius:12px}.product-overview__title[_ngcontent-%COMP%]{font-size:20px;font-weight:500;color:#fff}.product-overview__list[_ngcontent-%COMP%]{max-width:335px;width:100%;align-items:center;justify-content:center;color:#fff;display:flex;flex-direction:column;gap:20px;font-size:16px;font-weight:300}.product-overview__list-line[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.product-overview__group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.product-overview__group-title[_ngcontent-%COMP%]{color:#b0b0b0}.product-overview__footer[_ngcontent-%COMP%]{display:flex;gap:10px}"],changeDetection:0})};function Ke(n,e){if(n&1){let t=h();i(0,"app-product-card",6),s("click",function(){let u=C(t).$implicit,p=m();return x(p.openProduct(u))}),o()}if(n&2){let t=e.$implicit;_("product",t)}}var Be=class n{productsStore=f(V);dialog=B(ne,{dismissible:!0,label:"\u041E \u0442\u043E\u0432\u0430\u0440\u0435"});products$=this.productsStore.products$;openProduct(e){this.dialog(e).pipe(E(1)).subscribe()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=l({type:n,selectors:[["ng-component"]],features:[L([V,A])],decls:9,vars:2,consts:[[1,"products-page"],[1,"products-page__search"],["placeholder","\u041F\u043E\u0438\u0441\u043A","iconStart","@tui.search",1,"products-page__search-input"],["appearance","secondary-destructive","iconStart","@tui.settings-2","size","l","tuiIconButton","","type","button",1,"products-page__search-action"],[1,"products-page__list"],[3,"product"],[3,"click","product"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1),d(2,"app-input",2),i(3,"button",3),a(4," Settings "),o()(),i(5,"div",4),S(6,Ke,1,1,"app-product-card",5,ge),T(8,"async"),o()()),t&2&&(c(6),M(I(8,0,r.products$)))},dependencies:[F,H,$,J,k],styles:[".products-page__list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(163px,1fr));gap:10px}.products-page__search[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:space-between;margin-bottom:24px}.products-page__search-input[_ngcontent-%COMP%]{width:100%}.products-page__search-action[_ngcontent-%COMP%]{color:#fff;border-radius:100%;border:1px solid #4C4E51}"],changeDetection:0})};export{Be as ProductsPageComponent};
